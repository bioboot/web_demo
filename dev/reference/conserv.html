<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Score Residue Conservation At Each Position in an Alignment — conserv • Bio3D</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../.css" rel="stylesheet">



<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


<meta property="og:title" content="Score Residue Conservation At Each Position in an Alignment — conserv" />
<meta property="og:description" content="Quantifies residue conservation in a given protein sequence alignment
  by calculating the degree of amino acid variability in each column of
  the alignment." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">
        bio3d</a>
        <div class="info hidden-xs hidden-sm">
<!--          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
-->
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">2.4-1.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">INTRODUCTORY TUTORIALS</li>
    <li>
      <a href="../articles/bio3d_vignettes.html">Vignettes (old listing)</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">ADVANCED TUTORIALS</li>
    <li>
      <a href="../articles/b11.html">Title B1</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">WEBAPP TUTORIALS</li>
    <li>
      <a href="../articles/c11.html">Title C1</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Documentation
  </a>
</li>
        <li>
  <a href="../FAQ.html">
    <span class="fa fa-comments-o"></span>
     
    FAQ
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="http://thegrantlab.org/">
    <span class="fa fa-external-link"></span>
     
    Grant Lab
  </a>
</li>
<li>
  <a href="https://bitbucket.org/Grantlab/bio3d/src/master/">
    <span class="fa fa-bitbucket"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Score Residue Conservation At Each Position in an Alignment</h1>
    
    <div class="hidden name"><code>conserv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Quantifies residue conservation in a given protein sequence alignment
  by calculating the degree of amino acid variability in each column of
  the alignment.</p>
    </div>

    <pre class="usage"><span class='fu'>conserv</span>(<span class='kw'>x</span>, method = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"similarity"</span>,<span class='st'>"identity"</span>,<span class='st'>"entropy22"</span>,<span class='st'>"entropy10"</span>),
        sub.matrix = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bio3d"</span>, <span class='st'>"blosum62"</span>, <span class='st'>"pam30"</span>, <span class='st'>"other"</span>),
        matrix.file = <span class='kw'>NULL</span>, normalize.matrix = <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an alignment list object with <code>id</code> and <code>ali</code>
    components, similar to that generated by <code>read.fasta</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>the conservation assesment method.</p></td>
    </tr>
    <tr>
      <th>sub.matrix</th>
      <td><p>a matrix to score conservation.</p></td>
    </tr>
    <tr>
      <th>matrix.file</th>
      <td><p>a file name of an arbitary user matrix.</p></td>
    </tr>
    <tr>
      <th>normalize.matrix</th>
      <td><p>logical, if TRUE the matrix is normalized
    pior to assesing conservation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To assess the level of sequence conservation at each position in an
alignment, the &#8220;similarity&#8221;, &#8220;identity&#8221;, and
&#8220;entropy&#8221; per position can be calculated.</p>
<p>The &#8220;similarity&#8221; is defined as the average of the similarity
scores of all pairwise residue comparisons for that position in the
alignment, where the similarity score between any two residues is the
score value between those residues in the chosen substitution matrix
&#8220;sub.matrix&#8221;.</p>
<p>The &#8220;identity&#8221; i.e. the preference for a specific amino acid to
be found at a certain position, is assessed by averaging the identity
scores resulting from all possible pairwise comparisons at that position
in the alignment, where all identical residue comparisons are given a
score of 1 and all other comparisons are given a value of 0.</p>
<p>&#8220;Entropy&#8221; is based on Shannons information entropy. See the
<code>entropy</code> function for further details.</p>
<p>Note that the returned scores are normalized so that conserved columns
score 1 and diverse columns score 0.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a numeric vector of scores</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695--2696.
  Grant, B.J. et al. (2007) <em>J. Mol. Biol.</em> <b>368</b>, 1231--1248.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Barry Grant</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Each of these conservation scores has particular strengths and
  weaknesses.  For example, entropy elegantly captures amino acid
  diversity but fails to account for stereochemical similarities. By
  employing a combination of scores and taking the union of their
  respective conservation signals we expect to achieve a more
  comprehensive analysis of sequence conservation (Grant, 2007).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>read.fasta</code>, <code>read.fasta.pdb</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Read an example alignment</span>
<span class='kw'>aln</span> <span class='op'>&lt;-</span> <span class='fu'>read.fasta</span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"examples/hivp_xray.fa"</span>,package=<span class='st'>"bio3d"</span>))

<span class='co'>## Score conservation</span>
<span class='fu'>conserv</span>(x=<span class='kw'>aln</span><span class='op'>$</span><span class='kw'>ali</span>, method=<span class='st'>"similarity"</span>, sub.matrix=<span class='st'>"bio3d"</span>)</div><div class='output co'>#&gt;   [1] 9.765816e-01 9.952941e-01 8.513097e-01 9.733885e-01 9.952941e-01
#&gt;   [6] 9.952941e-01 6.199423e-01 9.850477e-01 1.000000e+00 9.379756e-01
#&gt;  [11] 1.000000e+00 1.000000e+00 9.766926e-01 7.709889e-01 1.000000e+00
#&gt;  [16] 9.790233e-01 1.000000e+00 1.000000e+00 9.766926e-01 9.258624e-01
#&gt;  [21] 9.905993e-01 9.790233e-01 1.000000e+00 9.730255e-01 8.756582e-01
#&gt;  [26] 1.000000e+00 1.000000e+00 9.915494e-01 1.000000e+00 9.776781e-01
#&gt;  [31] 9.545105e-01 9.590455e-01 6.639556e-01 9.443130e-01 9.271010e-01
#&gt;  [36] 9.153596e-01 5.746038e-01 1.000000e+00 9.743618e-01 9.761776e-01
#&gt;  [41] 7.836815e-01 9.766926e-01 9.577003e-01 1.000000e+00 9.518668e-01
#&gt;  [46] 9.404950e-01 9.750677e-01 9.831099e-01 9.534406e-01 9.534406e-01
#&gt;  [51] 1.109878e-05 1.109878e-05 1.000000e+00 1.000000e+00 1.000000e+00
#&gt;  [56] 9.564218e-01 9.790233e-01 9.766926e-01 9.860155e-01 9.813541e-01
#&gt;  [61] 1.000000e+00 9.766926e-01 9.674029e-01 9.696737e-01 4.100422e-01
#&gt;  [66] 8.215583e-01 1.000000e+00 9.860155e-01 5.633552e-01 9.813097e-01
#&gt;  [71] 9.790233e-01 9.971765e-01 8.923885e-01 9.696737e-01 9.831787e-01
#&gt;  [76] 1.000000e+00 9.860155e-01 9.836848e-01 9.766926e-01 1.000000e+00
#&gt;  [81] 9.720311e-01 1.000000e+00 1.000000e+00 6.371454e-01 1.000000e+00
#&gt;  [86] 8.794939e-01 9.674029e-01 1.000000e+00 1.000000e+00 9.776781e-01
#&gt;  [91] 9.850477e-01 9.340866e-01 1.000000e+00 9.743618e-01 9.813541e-01
#&gt;  [96] 1.000000e+00 5.092952e-01 9.790233e-01 1.000000e+00 1.000000e+00
#&gt; [101] 9.850477e-01</div><div class='input'><span class='co'>##conserv(x=aln$ali,method="entropy22", sub.matrix="other")</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="tidyverse">
  <p>Rough draft website demo based on [tidytemplate]()</p>
</div>

<div class="author">
  <p>
    Developed by Barry Grant, Xin-Qiu Yao, Lars Skjaerven, Julien Ide.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '1270c4079b26a138795263974bbf302d',
    indexName: 'tidyverse',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


