<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>All Atom Normal Mode Analysis — aanma • Bio3D</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="All Atom Normal Mode Analysis — aanma" />
<meta property="og:description" content="Perform all-atom elastic network model normal modes calculation of a protein
structure." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bio3D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4-1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-info"></span>
     
    Getting Started
  </a>
</li>
<li>
  <a href="../index.html">
    <span class="fa fa-book"></span>
     
    Tutorials
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../FAQ.html">
    <span class="fa fa-comments-o"></span>
     
    FAQ
  </a>
</li>
<li>
  <a href="../CODE_OF_CONDUCT.html">
    <span class="fa fa-newspaper-o"></span>
     
    News &amp; Updates
  </a>
</li>
<li>
  <a href="http://thegrantlab.org/">
    <span class="fa fa-external-link"></span>
     
    Grant Lab
  </a>
</li>
<li>
  <a href="https://bitbucket.org/Grantlab/bio3d/src/master/">
    <span class="fa fa-bitbucket fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>All Atom Normal Mode Analysis</h1>
    
    <div class="hidden name"><code>aanma.pdb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform all-atom elastic network model normal modes calculation of a protein
structure.</p>
    </div>

    <pre class="usage"><span class='fu'>aanma</span>(<span class='kw'>...</span>)

<span class='co'># S3 method for pdb</span>
<span class='fu'>aanma</span>(<span class='kw'>pdb</span>, pfc.fun = <span class='kw'>NULL</span>, mass = <span class='fl'>TRUE</span>, temp = <span class='fl'>300</span>,
  keep = <span class='kw'>NULL</span>, hessian = <span class='kw'>NULL</span>, outmodes = <span class='st'>"calpha"</span>, rm.wat = <span class='fl'>TRUE</span>,
  reduced = <span class='fl'>FALSE</span>, rtb = <span class='fl'>FALSE</span>, nmer = <span class='fl'>1</span>, <span class='kw'>...</span>)

<span class='fu'>rtb</span>(<span class='kw'>hessian</span>, <span class='kw'>pdb</span>, mass = <span class='fl'>TRUE</span>, nmer = <span class='fl'>1</span>, verbose = <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>additional arguments to <code>build.hessian</code> and
<code>aa2mass</code>. One useful option here for dealing with
unconventional residues is &#8216;mass.custom&#8217;, see the
<code>aa2mass</code> function for details.</p></td>
    </tr>
    <tr>
      <th>pdb</th>
      <td><p>an object of class <code>pdb</code> as obtained from function
<code>read.pdb</code>.</p></td>
    </tr>
    <tr>
      <th>pfc.fun</th>
      <td><p>customized pair force constant (&#8216;pfc&#8217;) function. The
provided function should take a vector of distances as an argument to
return a vector of force constants. If NULL, the default function
&#8216;aaenm2&#8217; will be employed. (See details below).</p></td>
    </tr>
    <tr>
      <th>mass</th>
      <td><p>logical, if TRUE the Hessian will be mass-weighted.</p></td>
    </tr>
    <tr>
      <th>temp</th>
      <td><p>numerical, temperature for which the amplitudes for scaling the
atomic displacement vectors are calculated. Set &#8216;temp=NULL&#8217; to
avoid scaling.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>numerical, final number of modes to be stored. Note that all
subsequent analyses are limited to this subset of modes. This option is
useful for very large structures and cases where memory may be limited.</p></td>
    </tr>
    <tr>
      <th>hessian</th>
      <td><p>hessian matrix as obtained from <code>build.hessian</code>.
For internal purposes and generally not intended for public use.</p></td>
    </tr>
    <tr>
      <th>outmodes</th>
      <td><p>either a character (&#8216;calpha&#8217; or &#8216;noh&#8217;) or atom
indices as obtained from <code>atom.select</code> specifying the atoms to
include in the resulting mode object. (See details below).</p></td>
    </tr>
    <tr>
      <th>rm.wat</th>
      <td><p>logical, if TRUE water molecules will be removed before
calculation.</p></td>
    </tr>
    <tr>
      <th>reduced</th>
      <td><p>logical, if TRUE the coarse-grained (&#8216;4-bead&#8217;) ENM will
be employed. (See details below).</p></td>
    </tr>
    <tr>
      <th>rtb</th>
      <td><p>logical, if TRUE the rotation-translation block based
approximate modes will be calculated. (See details below).</p></td>
    </tr>
    <tr>
      <th>nmer</th>
      <td><p>numerical, defines the number of residues per block (used only
when <code>rtb=TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical, if TRUE print detailed processing message</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of class &#8216;nma&#8217; with the following
   components:</p>
<dt>modes</dt><dd><p>numeric matrix with columns containing the normal mode
      vectors. Mode vectors are converted to unweighted Cartesian
      coordinates  when <code>mass=TRUE</code>. Note that the 6 first trivial
      eigenvectos appear in columns one to six.</p></dd>
   <dt>frequencies</dt><dd><p>numeric vector containing the vibrational
      frequencies corresponding to each mode (for <code>mass=TRUE</code>).</p></dd>
   <dt>force.constants</dt><dd><p>numeric vector containing the force constants
      corresponding to each mode (for <code>mass=FALSE)</code>).</p></dd>
   <dt>fluctuations</dt><dd><p>numeric vector of atomic fluctuations.</p></dd>
   <dt>U</dt><dd><p>numeric matrix with columns containing the raw
      eigenvectors. Equals to the <code>modes</code> component when
     <code>mass=FALSE</code> and <code>temp=NULL</code>.</p></dd>
   <dt>L</dt><dd><p>numeric vector containing the raw eigenvalues.</p></dd>
   <dt>xyz</dt><dd><p>numeric matrix of class <code>xyz</code> containing the
     Cartesian coordinates in which the calculation was performed.</p></dd>
   <dt>mass</dt><dd><p>numeric vector containing the residue masses used for the
     mass-weighting.</p></dd>
   <dt>temp</dt><dd><p>numerical, temperature for which the amplitudes for
     scaling the atomic displacement vectors are calculated.</p></dd>
   <dt>triv.modes</dt><dd><p>number of trivial modes.</p></dd>
   <dt>natoms</dt><dd><p>number of C-alpha atoms.</p></dd>
   <dt>call</dt><dd><p>the matched call.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function builds an elastic network model (ENM) based on all
heavy atoms of input <code>pdb</code>, and performs subsequent normal mode
analysis (NMA) in various manners. By default, the &#8216;aaenm2&#8217; force
field (defining of the spring constants between atoms) is used, which was
obtained by fitting to a local energy minimum of a crambin model
derived from the AMBER99SB force field. It employs a pair force constant
function which falls as r^-6, and specific force constants for
covalent and intra-residue atom pairs. See also <code>load.enmff</code>
for other force field options.</p>
<p>The <code>outmodes</code> argument controls the type of output modes. There are
two standard types of output modes: &#8216;noh&#8217; and &#8216;calpha&#8217;.
<code>outmodes='noh'</code> invokes regular all-atom based ENM-NMA. When
<code>outmodes='calpha'</code>, an effective Hessian with respect to all C-alpha
atoms will be first calculated using the same formula as in Hinsen et al.
NMA is then performed on this effective C-alpha based Hessian. In addition,
users can provide their own atom selection (see <code>atom.select</code>)
as the value of <code>outmodes</code> for customized output modes generation.</p>
<p>When <code>reduced=TRUE</code>, only a selection of all heavy atoms is used
to build the ENM. More specifically, three to five atoms per residue
constitute the model. Here the N, CA, C atoms represent the protein
backbone, and zero to two selected side chain atoms represent the side chain
(selected based on side chain size and the distance to CA). This
coarse-grained ENM has significantly improved computational efficiency and
similar prediction accuracy with respect to the all-atom ENM.</p>
<p>When <code>rtb=TRUE</code>, rotation-translation block (RTB) based approximate
modes will be calculated. In this method, each residue is assumed to be a
rigid body (or &#8216;block&#8217;) that has only rotational and translational
degrees of freedom. Intra-residue deformation is thus ignored.
(See Durand et al 1994 and Tama et al. 2000 for more details). N residues per
block is also supported, where N=1, 2, 3, etc. (See argument <code>nmer</code>).
The RTB method has significantly improved computational efficiency and
similar prediction accuracy with respect to the all-atom ENM.</p>
<p>By default the function will diagonalize the mass-weighted Hessian matrix.
The resulting mode vectors are moreover scaled by the thermal fluctuation
amplitudes.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Lars Skjaerven &amp; Xin-Qiu Yao</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hinsen, K. et al. (2000) <em>Chem. Phys.</em> <b>261</b>, 25.
   Durand, P. et al. (1994) <em>Biopolymers</em> <b>34</b>, 759.
   Tama, F. et al. (2000) <em>Proteins</em> <b>41</b>, 1.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>nma.pdb</code> for C-alpha based NMA, <code>aanma.pdbs</code> for
   ensemble all-atom NMA, <code>load.enmff</code> for available ENM force
   fields, and <code>fluct.nma</code>, <code>mktrj.nma</code>, and
   <code>dccm.nma</code> for various post-NMA calculations.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
   <span class='co'># All-atom NMA takes relatively long time - Don't run by default.</span>

   <span class='co'>## Fetch stucture</span>
   <span class='kw'>pdb</span> <span class='op'>&lt;-</span> <span class='fu'>read.pdb</span>( <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"examples/1hel.pdb"</span>, package=<span class='st'>"bio3d"</span>) )

   <span class='co'>## Calculate all-atom normal modes</span>
   <span class='kw'>modes.aa</span> <span class='op'>&lt;-</span> <span class='fu'>aanma</span>(<span class='kw'>pdb</span>, outmodes=<span class='st'>'noh'</span>)

   <span class='co'>## Calculate all-atom normal modes with RTB approximation</span>
   <span class='kw'>modes.aa.rtb</span> <span class='op'>&lt;-</span> <span class='fu'>aanma</span>(<span class='kw'>pdb</span>, outmodes=<span class='st'>'noh'</span>, rtb=<span class='fl'>TRUE</span>)

   <span class='co'>## Compare the two modes</span>
   <span class='fu'>rmsip</span>(<span class='kw'>modes.aa</span>, <span class='kw'>modes.aa.rtb</span>)

   <span class='co'>## Calculate C-alpha normal modes.</span>
   <span class='kw'>modes</span> <span class='op'>&lt;-</span> <span class='fu'>aanma</span>(<span class='kw'>pdb</span>)

   <span class='co'>## Calculate C-alpha normal modes with reduced ENM.</span>
   <span class='kw'>modes.cg</span> <span class='op'>&lt;-</span> <span class='fu'>aanma</span>(<span class='kw'>pdb</span>, reduced=<span class='fl'>TRUE</span>)

   <span class='co'>## Calculate C-alpha normal modes with RTB approximation</span>
   <span class='kw'>modes.rtb</span> <span class='op'>&lt;-</span> <span class='fu'>aanma</span>(<span class='kw'>pdb</span>, rtb=<span class='fl'>TRUE</span>)

   <span class='co'>## Compare modes</span>
   <span class='fu'>rmsip</span>(<span class='kw'>modes</span>, <span class='kw'>modes.cg</span>)
   <span class='fu'>rmsip</span>(<span class='kw'>modes</span>, <span class='kw'>modes.rtb</span>)

   <span class='co'>## Print modes</span>
   <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='kw'>modes</span>)

   <span class='co'>## Plot modes</span>
   <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>modes</span>)

   <span class='co'>## Visualize modes</span>
   <span class='co'>#m7 &lt;- mktrj.nma(modes, mode=7, file="mode_7.pdb", pdb=pdb)</span>
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Barry Grant, Xin-Qiu Yao, Lars Skjaerven, Julien Ide.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


