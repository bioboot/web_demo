<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plots with marginal SSE annotation — plot.bio3d • Bio3D</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plots with marginal SSE annotation — plot.bio3d" />
<meta property="og:description" content="Draw a standard scatter plot with optional secondary structure in the
  marginal regions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bio3D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4-1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-info"></span>
     
    Getting Started
  </a>
</li>
<li>
  <a href="../index.html">
    <span class="fa fa-book"></span>
     
    Tutorials
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../FAQ.html">
    <span class="fa fa-comments-o"></span>
     
    FAQ
  </a>
</li>
<li>
  <a href="../CODE_OF_CONDUCT.html">
    <span class="fa fa-newspaper-o"></span>
     
    News &amp; Updates
  </a>
</li>
<li>
  <a href="http://thegrantlab.org/">
    <span class="fa fa-external-link"></span>
     
    Grant Lab
  </a>
</li>
<li>
  <a href="https://bitbucket.org/Grantlab/bio3d/src/master/">
    <span class="fa fa-bitbucket fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots with marginal SSE annotation</h1>
    
    <div class="hidden name"><code>plot.bio3d.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draw a standard scatter plot with optional secondary structure in the
  marginal regions.</p>
    </div>

    <pre class="usage"><span class='fu'>plotb3</span>(<span class='kw'>x</span>, resno = <span class='kw'>NULL</span>, rm.gaps = <span class='fl'>FALSE</span>, type = <span class='st'>"h"</span>,
             main = <span class='st'>""</span>, sub = <span class='st'>""</span>,
             xlim = <span class='kw'>NULL</span>, ylim = <span class='kw'>NULL</span>, ylim2zero = <span class='fl'>TRUE</span>,
             xlab = <span class='st'>"Residue"</span>, ylab = <span class='kw'>NULL</span>, 
             axes = <span class='fl'>TRUE</span>, ann = <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"ann"</span>), col = <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"col"</span>),
             sse = <span class='kw'>NULL</span>, sse.type=<span class='st'>"classic"</span>, sse.min.length=<span class='fl'>5</span>,
             top = <span class='fl'>TRUE</span>, bot = <span class='fl'>TRUE</span>, 
             helix.col = <span class='st'>"gray20"</span>, sheet.col = <span class='st'>"gray80"</span>,
             sse.border = <span class='fl'>FALSE</span>, <span class='kw'>...</span>)

             <span class='co'># S3 method for bio3d</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a numeric vector of values to be plotted.  Any reasonable way of
    defining these plot coordinates is acceptable.  See the function
    &#8216;xy.coords&#8217; for details.</p></td>
    </tr>
    <tr>
      <th>resno</th>
      <td><p>an optional vector with length equal to that of
    &#8216;x&#8217; that will be used to annotate the xaxis. This is typically
    a vector of residue numbers. If NULL residue positions from 1 to the
    length of &#8216;x&#8217; will be used. See examples below.</p></td>
    </tr>
    <tr>
      <th>rm.gaps</th>
      <td><p>logical, if TRUE gaps in <code>x</code>, indicated by NA values,
    will be removed from plot.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>one-character string giving the type of plot desired.  The
    following values are possible, (for details, see &#8216;plot&#8217;): &#8216;p&#8217;
    for points, &#8216;l&#8217; for lines, &#8216;o&#8217; for over-plotted points and
    lines, &#8216;b&#8217;, &#8216;c&#8217;) for points joined by lines,
    &#8216;s&#8217; and &#8216;S&#8217; for stair steps and &#8216;h&#8217; for
    histogram-like vertical lines.  Finally, &#8216;n&#8217; does not produce
    any points or lines.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>a main title for the plot, see also &#8216;title&#8217;.</p></td>
    </tr>
    <tr>
      <th>sub</th>
      <td><p>a sub-title for the plot.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>the x limits (x1,x2) of the plot.  Note that x1 &gt; x2 is
          allowed and leads to a reversed axis.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>the y limits of the plot.</p></td>
    </tr>
    <tr>
      <th>ylim2zero</th>
      <td><p>logical, if TRUE the y-limits are forced to start at zero.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>a label for the x axis, defaults to a description of &#8216;x&#8217;.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>a label for the y axis, defaults to a description of &#8216;y&#8217;.</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>a logical value indicating whether both axes should be drawn
    on the plot.  Use graphical parameter &#8216;xaxt&#8217; or
    &#8216;yaxt&#8217; to suppress just one of the axes.</p></td>
    </tr>
    <tr>
      <th>ann</th>
      <td><p>a logical value indicating whether the default annotation
    (title and x and y axis labels) should appear on the plot.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>The colors for lines and points.  Multiple colors can be
    specified so that each point is given its own color.  If there are
    fewer colors than points they are recycled in the standard fashion.
    Lines are plotted in the first color specified.</p></td>
    </tr>
    <tr>
      <th>sse</th>
      <td><p>secondary structure object as returned from
    <code>dssp</code>, <code>stride</code> or in certain cases
    <code>read.pdb</code>.</p></td>
    </tr>
    <tr>
      <th>sse.type</th>
      <td><p>single element character vector that determines the
    type of secondary structure annotation drawn. The following values
    are possible, &#8216;classic&#8217; and &#8216;fancy&#8217;. See details and 
    examples below.</p></td>
    </tr>
    <tr>
      <th>sse.min.length</th>
      <td><p>a single numeric value giving the length below
    which secondary structure elements will not be drawn. This is useful
    for the exclusion of short helix and strand regions that can often crowd
    these forms of plots.</p></td>
    </tr>
    <tr>
      <th>top</th>
      <td><p>logical, if TRUE rectangles for each sse are drawn towards
    the top of the plotting region.</p></td>
    </tr>
    <tr>
      <th>bot</th>
      <td><p>logical, if TRUE rectangles for each sse are drawn towards
    the bottom of the plotting region.</p></td>
    </tr>
    <tr>
      <th>helix.col</th>
      <td><p>The colors for rectangles representing alpha helices.</p></td>
    </tr>
    <tr>
      <th>sheet.col</th>
      <td><p>The colors for rectangles representing beta strands.</p></td>
    </tr>
    <tr>
      <th>sse.border</th>
      <td><p>The border color for all sse rectangles.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other graphical parameters.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is useful for plotting per-residue numeric vectors for a
  given protein structure (e.g. results from RMSF, PCA, NMA etc.) along
  with a schematic representation of major secondary structure elements.</p>
<p>Two forms of secondary structure annotation are available: so called
  &#8216;classic&#8217; and &#8216;fancy&#8217;. The former draws marginal
  rectangles and has been available within Bio3D from version 0.1. The
  later draws more &#8216;fancy&#8217; (and distracting) 3D like helices and
  arrowed strands.</p>  
<p>See the functions &#8216;plot.default&#8217;, <code>dssp</code> and <code>stride</code> 
  for further details.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Called for its effect.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695--2696.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Barry Grant</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Be sure to check the correspondence of your &#8216;sse&#8217; object with the
  &#8216;x&#8217; values being plotted as no internal checks are performed.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot.default</a></code>, <code>dssp</code>, <code>stride</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># \donttest{</span>
<span class='co'># PDB server connection required - testing excluded</span>

<span class='co'>## Plot of B-factor values along with secondary structure from PDB</span>
<span class='kw'>pdb</span> <span class='op'>&lt;-</span> <span class='fu'>read.pdb</span>( <span class='st'>"1bg2"</span> )
<span class='kw'>bfac</span> <span class='op'>&lt;-</span> <span class='kw'>pdb</span><span class='op'>$</span><span class='kw'>atom</span>[<span class='kw'>pdb</span><span class='op'>$</span><span class='kw'>calpha</span>,<span class='st'>"b"</span>]
<span class='fu'>plot.bio3d</span>(<span class='kw'>bfac</span>, sse=<span class='kw'>pdb</span>, ylab=<span class='st'>"B-factor"</span>, col=<span class='st'>"gray"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='kw'>bfac</span>, typ=<span class='st'>"l"</span>)
<span class='co'># }</span>

<span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## Use PDB residue numbers and include short secondary structure elements</span>
<span class='fu'>plot.bio3d</span>(<span class='kw'>pdb</span><span class='op'>$</span><span class='kw'>atom</span>[<span class='kw'>pdb</span><span class='op'>$</span><span class='kw'>calpha</span>,<span class='st'>"b"</span>], sse=<span class='kw'>pdb</span>, resno=<span class='kw'>pdb</span>, ylab=<span class='st'>"B-factor"</span>,
  typ=<span class='st'>"l"</span>, lwd=<span class='fl'>1.5</span>, col=<span class='st'>"blue"</span>, sse.min.length=<span class='fl'>0</span>)


<span class='co'>## Calculate secondary structure using stride() or dssp()</span>
<span class='co'>#sse &lt;- stride(pdb)</span>
<span class='kw'>sse</span> <span class='op'>&lt;-</span> <span class='fu'>dssp</span>(<span class='kw'>pdb</span>)

<span class='co'>## Plot of B-factor values along with calculated secondary structure</span>
<span class='fu'>plot.bio3d</span>(<span class='kw'>pdb</span><span class='op'>$</span><span class='kw'>atom</span>[<span class='kw'>pdb</span><span class='op'>$</span><span class='kw'>calpha</span>,<span class='st'>"b"</span>], sse=<span class='kw'>sse</span>, ylab=<span class='st'>"B-factor"</span>, typ=<span class='st'>"l"</span>,
col=<span class='st'>"blue"</span>, lwd=<span class='fl'>2</span>)
}

<span class='co'># \donttest{</span>
<span class='co'># PDB server connection required - testing excluded</span>

<span class='co'>## Plot 'aligned' data respecting gap positions</span>
<span class='fu'><a href='https://rdrr.io/r/base/attach.html'>attach</a></span>(<span class='kw'>transducin</span>)

<span class='kw'>pdb</span> <span class='op'>=</span> <span class='fu'>read.pdb</span>(<span class='st'>"1tnd"</span>) <span class='co'>## Reference PDB see: pdbs$id[1]</span>
<span class='kw'>pdb</span> <span class='op'>=</span> <span class='fu'>trim.pdb</span>(<span class='kw'>pdb</span>, inds=<span class='fu'>atom.select</span>(<span class='kw'>pdb</span>, chain=<span class='st'>"A"</span>))

<span class='co'>## Plot of B-factor values with gaps</span>
<span class='fu'>plot.bio3d</span>(<span class='kw'>pdbs</span><span class='op'>$</span><span class='kw'>b</span>, resno=<span class='kw'>pdb</span>, sse=<span class='kw'>pdb</span>, ylab=<span class='st'>"B-factor"</span>)

<span class='co'>## Plot of B-factor values after removing all gaps </span>
<span class='fu'>plot.bio3d</span>(<span class='kw'>pdbs</span><span class='op'>$</span><span class='kw'>b</span>, rm.gaps=<span class='fl'>TRUE</span>, resno = <span class='kw'>pdb</span>, sse=<span class='kw'>pdb</span>, ylab=<span class='st'>"B-factor"</span>)

<span class='fu'><a href='https://rdrr.io/r/base/detach.html'>detach</a></span>(<span class='kw'>transducin</span>)
<span class='co'># }</span>

<span class='co'>## Fancy secondary structure elements</span>
<span class='co'>##plot.bio3d(pdb$atom[pdb$calpha,"b"], sse=pdb, ssetype="fancy")</span>
<span class='co'>## Currently not implemented</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Barry Grant, Xin-Qiu Yao, Lars Skjaerven, Julien Ide.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


